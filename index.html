<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chris Johnson – Cloud Resume</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      line-height: 1.6;
      max-width: 900px;
    }
    h1, h2, h3 {
      color: #333;
    }
    .section {
      margin-bottom: 30px;
    }
    ul {
      margin-top: 5px;
    }
  </style>
</head>

<body>
  <h1 id="name">Loading...</h1>
  <p id="summary"></p>

  <div class="section">
    <h2>Certifications</h2>
    <div id="certifications"></div>
  </div>

  <div class="section">
    <h2>Professional Experience</h2>
    <div id="experience"></div>
  </div>

  <div class="section">
    <h2>Skills</h2>
    <div id="skills"></div>
  </div>

  <script>
    async function loadResume() {
      try {
        const response = await fetch("https://function-resume02-ghgmfebecxepgfgd.ukwest-01.azurewebsites.net/api/getresume"); 
        const data = await response.json();

        // Name
        document.getElementById("name").textContent =
          `${data.personal_info.firstName} ${data.personal_info.lastName}`;

        // Summary
        document.getElementById("summary").textContent = data.summary;

        // Certifications
        const certsDiv = document.getElementById("certifications");
        data.certifications.forEach(group => {
          const section = document.createElement("div");
          section.innerHTML = `<h3>${group.name}</h3>`;
          const list = document.createElement("ul");
          group.items.forEach(item => {
            const li = document.createElement("li");
            li.textContent = item;
            list.appendChild(li);
          });
          section.appendChild(list);
          certsDiv.appendChild(section);
        });

        // Experience
        const expDiv = document.getElementById("experience");
        data.professional_experience.forEach(job => {
          const jobDiv = document.createElement("div");
          jobDiv.innerHTML = `
            <h3>${job.title} – ${job.company}</h3>
            <p><strong>${job.duration}</strong></p>
          `;

          const respList = document.createElement("ul");
          job.responsibilities.forEach(r => {
            const li = document.createElement("li");
            li.textContent = r;
            respList.appendChild(li);
          });

          const achList = document.createElement("ul");
          job.key_achievements.forEach(a => {
            const li = document.createElement("li");
            li.textContent = a;
            achList.appendChild(li);
          });

          jobDiv.appendChild(document.createElement("h4")).textContent = "Responsibilities";
          jobDiv.appendChild(respList);
          jobDiv.appendChild(document.createElement("h4")).textContent = "Key Achievements";
          jobDiv.appendChild(achList);

          expDiv.appendChild(jobDiv);
        });

        // Skills
        const skillsDiv = document.getElementById("skills");
        data.skills.forEach(skillGroup => {
          const groupDiv = document.createElement("div");
          groupDiv.innerHTML = `<h3>${skillGroup.category}</h3>`;
          const list = document.createElement("ul");
          skillGroup.tasks.forEach(task => {
            const li = document.createElement("li");
            li.textContent = task;
            list.appendChild(li);
          });
          groupDiv.appendChild(list);
          skillsDiv.appendChild(groupDiv);
        });

      } catch (err) {
        document.body.innerHTML = "<h1>Error loading resume</h1><p>" + err + "</p>";
      }
    }

    loadResume();
  </script>

</body>
</html>
